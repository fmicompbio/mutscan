<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Process an experiment with multiple variable sequences — linkMultipleVariants • mutscan</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Process an experiment with multiple variable sequences — linkMultipleVariants"><meta property="og:description" content="This function enables the processing of data sets with multiple
variable sequences, which should potentially be handled in different
ways. For example, a barcode association experiment
with two variable sequences (the barcode and the biological variant)
that need to be processed differently, e.g. in terms of matching to
wildtype sequences or collapsing of similar sequences.
In contrast, while digestFastqs allow the specification
of multiple variable sequences (within each of the forward and reverse
reads), they will be concatenated and processed as a single unit."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mutscan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/mutscan.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Process an experiment with multiple variable sequences</h1>
    
    <div class="hidden name"><code>linkMultipleVariants.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function enables the processing of data sets with multiple
variable sequences, which should potentially be handled in different
ways. For example, a barcode association experiment
with two variable sequences (the barcode and the biological variant)
that need to be processed differently, e.g. in terms of matching to
wildtype sequences or collapsing of similar sequences.
In contrast, while <code>digestFastqs</code> allow the specification
of multiple variable sequences (within each of the forward and reverse
reads), they will be concatenated and processed as a single unit.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">linkMultipleVariants</span><span class="op">(</span>combinedDigestParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>combinedDigestParams</dt>
<dd><p>A named list of arguments to
<code>digestFastqs</code> for the combined ("naive") run.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments providing arguments to <code>digestFastqs</code>
for the separate runs (processing each variable sequence in turn).
Each argument must be a named list of arguments to <code>digestFastqs</code>.
In addition, arguments <code>collapseMaxDist</code>, <code>collapseMinScore</code>
and <code>collapseMinRatio</code> can be specified, and will be passed on 
to <code>collapseMutantsBySimilarity</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list with the following elements:</p><ul><li><p>countAggregated - a <code>tibble</code> with columns corresponding to 
    each of the variable sequences, and a column with the total observed 
    read count for the combination.</p></li>
<li><p>convSeparate - a list of conversion tables from the respective 
    separate runs.</p></li>
<li><p>outCombined - the <code>digestFastqs</code> output for the combined run.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>linkMultipleVariants will process the input in the following way:</p><ul><li><p>First, run <code>digestFastqs</code> with the parameters provided
    in <code>combinedDigestParams</code>. Typically, this will be a
    "naive" counting run, where the frequencies of all observed
    variants are tabulated. The variable sequences
    within the forward and reverse reads, respectively, will be
    processed as a single sequence.</p></li>
<li><p>Next, run <code>digestFastqs</code> with each of the additional
    parameter sets provided (<code>...</code>). Each of these should
    correspond to a single variable sequence from the combined
    run (i.e., if there are two Vs in the element specifications
    in the combined run, there should be two additional
    parameter sets provided, each corresponding to the
    processing of one variable sequence part). It is assumed
    that the order of the additional arguments correspond to the
    order of the variable sequences in the combined run, in such a way
    that if the variable sequences extracted in each of the separate
    runs are concatenated in the order that the parameter sets are
    provided to <code>linkMultipleVariants</code>, they will form the variable
    sequence extracted in the combined run.</p></li>
<li><p>The result of each of the separate runs is a 'conversion table',
    containing the final set of identified sequence variants as well
    as all individual sequences corresponding to each of them. This
    is then combined with the count table from the combined, "naive"
    run in order to create an aggregated count table. More precisely,
    each sequence in the combined run is split into the constituent
    variable sequences, and
    each variable sequence is then matched to the output from the right
    separate run, from which the final feature ID (mutant name, or
    collapsed sequence) will be extracted and used to replace the original
    sequence in the combined count table. Once all the matches are done,
    rows with NAs (where no match could be found in the separate run)
    are removed and the counts are aggregated across all identical
    combinations of variable sequences.</p></li>
</ul><p>In order to define the <code>elementsForward</code> and <code>elementsReverse</code>
arguments for the separate runs, a strategy that often works is to simply
copy the arguments from the combined run, and successively replace all
but one of the 'V's by 'S'. This will effectively process one variable
sequence at the time, while keeping all other elements of the reads
consistent (since this can affect e.g. filtering criteria). Note that
to process individual variable sequences in the reverse read, you also
need to swap the 'forward' and 'reverse' specifications (since
<code>digestFastqs</code> requires a forward read).</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Charlotte Soneson, Michael Stadler</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Charlotte Soneson, Michael Stadler.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

