<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate logFCs relative to WT using edgeR — calculateRelativeFC • mutscan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate logFCs relative to WT using edgeR — calculateRelativeFC"><meta name="description" content="Calculate logFCs and associated p-values for a given comparison, using
either limma or the Negative Binomial quasi-likelihood framework of edgeR.
The observed counts for the WT variants can be used as offsets in the model."><meta property="og:description" content="Calculate logFCs and associated p-values for a given comparison, using
either limma or the Negative Binomial quasi-likelihood framework of edgeR.
The observed counts for the WT variants can be used as offsets in the model."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mutscan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/mutscan.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate logFCs relative to WT using edgeR</h1>

      <div class="d-none name"><code>calculateRelativeFC.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate logFCs and associated p-values for a given comparison, using
either limma or the Negative Binomial quasi-likelihood framework of edgeR.
The observed counts for the WT variants can be used as offsets in the model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calculateRelativeFC</span><span class="op">(</span></span>
<span>  <span class="va">se</span>,</span>
<span>  <span class="va">design</span>,</span>
<span>  coef <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  contrast <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  WTrows <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  selAssay <span class="op">=</span> <span class="st">"counts"</span>,</span>
<span>  pseudocount <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"edgeR"</span>,</span>
<span>  normMethod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">WTrows</span><span class="op">)</span>, <span class="st">"TMM"</span>, <span class="st">"sum"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-se">se<a class="anchor" aria-label="anchor" href="#arg-se"></a></dt>
<dd><p>SummarizedExperiment object.</p></dd>


<dt id="arg-design">design<a class="anchor" aria-label="anchor" href="#arg-design"></a></dt>
<dd><p>Design matrix. The rows of the design matrix must be in the
same order as the columns in <code>se</code>.</p></dd>


<dt id="arg-coef">coef<a class="anchor" aria-label="anchor" href="#arg-coef"></a></dt>
<dd><p>Coefficient(s) to test with edgeR or limma.</p></dd>


<dt id="arg-contrast">contrast<a class="anchor" aria-label="anchor" href="#arg-contrast"></a></dt>
<dd><p>Numeric contrast to test with edgeR or limma.</p></dd>


<dt id="arg-wtrows">WTrows<a class="anchor" aria-label="anchor" href="#arg-wtrows"></a></dt>
<dd><p>Vector of row names that will be used as the reference when
calculating logFCs and statistics. If more than one value is provided, the
sum of the corresponding counts is used to generate offsets. If NULL,
offsets will be defined as the effective library sizes (using TMM
normalization factors).</p></dd>


<dt id="arg-selassay">selAssay<a class="anchor" aria-label="anchor" href="#arg-selassay"></a></dt>
<dd><p>Assay to select from <code>se</code> for the analysis.</p></dd>


<dt id="arg-pseudocount">pseudocount<a class="anchor" aria-label="anchor" href="#arg-pseudocount"></a></dt>
<dd><p>Pseudocount to add when calculating log-fold changes.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Either 'edgeR' or 'limma'. If set to 'limma', voom is used to
transform the counts and estimate observation weights before applying
limma. In this case, the results also contain the standard errors of the
logFCs.</p></dd>


<dt id="arg-normmethod">normMethod<a class="anchor" aria-label="anchor" href="#arg-normmethod"></a></dt>
<dd><p>Character scalar indicating which normalization method
should be used to calculate size factors. Should be either <code>"TMM"</code> or
<code>"csaw"</code> when <code>WTrows</code> is <code>NULL</code>, and <code>"geomean"</code> or
<code>"sum"</code> when <code>WTrows</code> is provided.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>data.frame</code> with output from the statistical testing
framework (edgeR or limma).</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Charlotte Soneson, Michael Stadler</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"GSE102901_cis_se.rds"</span>,</span></span>
<span class="r-in"><span>                          package <span class="op">=</span> <span class="st">"mutscan"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Replicate</span> <span class="op">+</span> <span class="va">Condition</span>,</span></span>
<span class="r-in"><span>                              data <span class="op">=</span> <span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                              </span></span>
<span class="r-in"><span><span class="co">## Calculate "absolute" log-fold changes with edgeR</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">calculateRelativeFC</span><span class="op">(</span><span class="va">se</span>, <span class="va">design</span>, coef <span class="op">=</span> <span class="st">"Conditioncis_output"</span>, </span></span>
<span class="r-in"><span>                           method <span class="op">=</span> <span class="st">"edgeR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             logFC    logCPM         F       PValue          FDR logFC_shrunk</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.0.WT  1.9721334 20.083627 56.768150 2.160897e-10 3.601495e-09    1.9721331</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAC 1.3136230  4.688782 17.640288 8.439695e-05 2.910240e-04    1.2984544</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAG 1.0392549  5.677955 13.791731 4.313291e-04 1.327167e-03    1.0342409</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACC 2.0874024 12.862431 62.628899 4.638644e-11 1.159661e-09    2.0873503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACG 1.8698694 13.513672 50.764347 1.134839e-09 1.194568e-08    1.8698442</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AGC 0.9309018  4.754181  9.170734 3.545487e-03 8.975917e-03    0.9228638</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         df.total df.prior df.test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.0.WT  63.85553 60.85531       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAC 63.85462 60.85531       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAG 63.85524 60.85531       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACC 63.85553 60.85531       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACG 63.85553 60.85531       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AGC 63.85487 60.85531       1</span>
<span class="r-in"><span><span class="co">## Calculate log-fold changes relative to the WT sequence with edgeR</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="st">"f.0.WT"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">calculateRelativeFC</span><span class="op">(</span><span class="va">se</span>, <span class="va">design</span>, coef <span class="op">=</span> <span class="st">"Conditioncis_output"</span>, </span></span>
<span class="r-in"><span>                           method <span class="op">=</span> <span class="st">"edgeR"</span>, WTrows <span class="op">=</span> <span class="st">"f.0.WT"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 logFC    logCPM         F       PValue          FDR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.0.WT   4.209817e-16 19.757846  0.000000 1.000000e+00 1.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAC -6.078796e-01  4.553595  9.224434 1.337186e-02 1.601421e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAG -8.740695e-01  5.655807 24.839338 6.574158e-04 1.125187e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACC  1.207258e-01 12.506900 28.957264 3.790068e-04 7.018644e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACG -1.016593e-01 13.217924 67.771782 1.324404e-05 4.905202e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AGC -9.855150e-01  4.738963 18.559705 1.767705e-03 2.658202e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          logFC_shrunk df.total df.prior df.test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.0.WT   4.802398e-16 9.426352 6.426305       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAC -6.661972e-01 9.423708 6.426305       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAG -8.823465e-01 9.425925 6.426305       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACC  1.207031e-01 9.426352 6.426305       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACG -1.016627e-01 9.426352 6.426305       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AGC -1.030935e+00 9.424817 6.426305       1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Calculate "absolute" log-fold changes with limma</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">calculateRelativeFC</span><span class="op">(</span><span class="va">se</span>, <span class="va">design</span>, coef <span class="op">=</span> <span class="st">"Conditioncis_output"</span>, </span></span>
<span class="r-in"><span>                           method <span class="op">=</span> <span class="st">"limma"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             logFC      CI.L     CI.R   AveExpr        t      P.Value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.0.WT  1.9474761 1.5292108 2.365741 19.757630 9.144191 9.237987e-19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAC 1.2874854 0.6745388 1.900432  4.417300 4.125197 4.227413e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAG 1.0494394 0.5382396 1.560639  5.581250 4.031733 6.250330e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACC 2.0664575 1.6160089 2.516906 12.504065 9.009616 2.738680e-18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACG 1.8444895 1.3981560 2.290823 13.217517 8.115994 2.737555e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AGC 0.9173399 0.3223443 1.512336  4.627474 3.027900 2.568326e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            adj.P.Val         B  se.logFC df.total df.prior</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.0.WT  3.079329e-17 34.491225 0.2129741      600      Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAC 1.537241e-04  1.802578 0.3121028      600      Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAG 2.232261e-04  1.302156 0.2602949      600      Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACC 7.824800e-17 33.291805 0.2293613      600      Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACG 3.421944e-14 25.725045 0.2272660      600      Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AGC 6.941422e-03 -2.063388 0.3029624      600      Inf</span>
<span class="r-in"><span><span class="co">## Calculate log-fold changes relative to the WT sequence with limma</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="st">"f.0.WT"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">calculateRelativeFC</span><span class="op">(</span><span class="va">se</span>, <span class="va">design</span>, coef <span class="op">=</span> <span class="st">"Conditioncis_output"</span>, </span></span>
<span class="r-in"><span>                           method <span class="op">=</span> <span class="st">"limma"</span>, WTrows <span class="op">=</span> <span class="st">"f.0.WT"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 logFC        CI.L        CI.R   AveExpr             t</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.0.WT   9.552321e-08 -0.02134725  0.02134744 19.757630  1.061086e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAC -6.050453e-01 -1.19863707 -0.01145359  4.417300 -2.417050e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAG -8.921801e-01 -1.41471440 -0.36964582  5.581250 -4.048771e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACC  1.233369e-01  0.05349146  0.19318235 12.504065  4.187362e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACG -1.002978e-01 -0.12552201 -0.07507357 13.217517 -9.428860e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AGC -9.852809e-01 -1.66066239 -0.30989941  4.627474 -3.459365e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              P.Value    adj.P.Val           B    se.logFC df.total df.prior</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.0.WT  9.999918e-01 0.9999918338 -10.2853001 0.009002401 6.904162 3.904162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAC 4.676895e-02 0.0534502279  -4.8181840 0.250323924 6.904162 3.904162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAG 5.021241e-03 0.0079702233  -2.7275623 0.220358245 6.904162 3.904162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACC 4.226773e-03 0.0071038198  -4.8399208 0.029454563 6.904162 3.904162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACG 3.435219e-05 0.0002862682   0.1043135 0.010637319 6.904162 3.904162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AGC 1.078800e-02 0.0151943682  -3.3263517 0.284815526 6.904162 3.904162</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Charlotte Soneson, Michael Stadler.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

