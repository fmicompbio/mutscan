<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate logFCs relative to WT using edgeR — calculateRelativeFC • mutscan</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate logFCs relative to WT using edgeR — calculateRelativeFC"><meta property="og:description" content="Calculate logFCs and associated p-values for a given comparison, using
either limma or the Negative Binomial quasi-likelihood framework of edgeR.
The observed counts for the WT variants can be used as offsets in the model."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mutscan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.34</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/mutscan.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate logFCs relative to WT using edgeR</h1>
    
    <div class="hidden name"><code>calculateRelativeFC.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate logFCs and associated p-values for a given comparison, using
either limma or the Negative Binomial quasi-likelihood framework of edgeR.
The observed counts for the WT variants can be used as offsets in the model.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calculateRelativeFC</span><span class="op">(</span></span>
<span>  <span class="va">se</span>,</span>
<span>  <span class="va">design</span>,</span>
<span>  coef <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  contrast <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  WTrows <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  selAssay <span class="op">=</span> <span class="st">"counts"</span>,</span>
<span>  pseudocount <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"edgeR"</span>,</span>
<span>  normMethod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">WTrows</span><span class="op">)</span>, <span class="st">"TMM"</span>, <span class="st">"sum"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>se</dt>
<dd><p>SummarizedExperiment object.</p></dd>


<dt>design</dt>
<dd><p>Design matrix. The rows of the design matrix must be in the
same order as the columns in <code>se</code>.</p></dd>


<dt>coef</dt>
<dd><p>Coefficient(s) to test with edgeR or limma.</p></dd>


<dt>contrast</dt>
<dd><p>Numeric contrast to test with edgeR or limma.</p></dd>


<dt>WTrows</dt>
<dd><p>Vector of row names that will be used as the reference when
calculating logFCs and statistics. If more than one value is provided, the
sum of the corresponding counts is used to generate offsets. If NULL,
offsets will be defined as the effective library sizes (using TMM
normalization factors).</p></dd>


<dt>selAssay</dt>
<dd><p>Assay to select from <code>se</code> for the analysis.</p></dd>


<dt>pseudocount</dt>
<dd><p>Pseudocount to add when calculating log-fold changes.</p></dd>


<dt>method</dt>
<dd><p>Either 'edgeR' or 'limma'. If set to 'limma', voom is used to
transform the counts and estimate observation weights before applying
limma. In this case, the results also contain the standard errors of the
logFCs.</p></dd>


<dt>normMethod</dt>
<dd><p>Character scalar indicating which normalization method
should be used to calculate size factors. Should be either <code>"TMM"</code> or
<code>"csaw"</code> when <code>WTrows</code> is <code>NULL</code>, and <code>"geomean"</code> or
<code>"sum"</code> when <code>WTrows</code> is provided.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code>data.frame</code> with output from the statistical testing 
framework (edgeR or limma).</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Charlotte Soneson, Michael Stadler</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"GSE102901_cis_se.rds"</span>,</span></span>
<span class="r-in"><span>                          package <span class="op">=</span> <span class="st">"mutscan"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Replicate</span> <span class="op">+</span> <span class="va">Condition</span>,</span></span>
<span class="r-in"><span>                              data <span class="op">=</span> <span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                              </span></span>
<span class="r-in"><span><span class="co">## Calculate "absolute" log-fold changes with edgeR</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">calculateRelativeFC</span><span class="op">(</span><span class="va">se</span>, <span class="va">design</span>, coef <span class="op">=</span> <span class="st">"Conditioncis_output"</span>, </span></span>
<span class="r-in"><span>                           method <span class="op">=</span> <span class="st">"edgeR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             logFC    logCPM         F       PValue          FDR logFC_shrunk</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.0.WT  1.9721335 20.083627 27.532794 2.145445e-07 1.159700e-06    1.9721331</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAC 1.3087303  4.688782 16.225636 6.344919e-05 2.226287e-04    1.2984544</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAG 1.0380054  5.677955 12.571727 4.221560e-04 1.319237e-03    1.0342409</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACC 2.0874169 12.862431 63.510847 8.064604e-15 2.016151e-13    2.0873503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACG 1.8698799 13.513672 49.686087 4.976328e-12 5.854503e-11    1.8698442</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AGC 0.9289962  4.754181  8.417687 3.852141e-03 9.752256e-03    0.9228638</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         df.total df.prior df.test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.0.WT       600      Inf       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAC      600      Inf       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAG      600      Inf       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACC      600      Inf       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACG      600      Inf       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AGC      600      Inf       1</span>
<span class="r-in"><span><span class="co">## Calculate log-fold changes relative to the WT sequence with edgeR</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="st">"f.0.WT"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">calculateRelativeFC</span><span class="op">(</span><span class="va">se</span>, <span class="va">design</span>, coef <span class="op">=</span> <span class="st">"Conditioncis_output"</span>, </span></span>
<span class="r-in"><span>                           method <span class="op">=</span> <span class="st">"edgeR"</span>, WTrows <span class="op">=</span> <span class="st">"f.0.WT"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 logFC    logCPM        F       PValue          FDR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.0.WT   4.383938e-16 19.757846  0.00000 1.000000e+00 1.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAC -6.730437e-01  4.553595  4.09304 4.697062e-02 5.337571e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAG -8.855800e-01  5.655807 10.60344 1.757716e-03 2.493214e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACC  1.207057e-01 12.506900 35.28527 1.064256e-07 4.343902e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACG -1.016650e-01 13.217924 59.46509 7.083771e-11 4.570175e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AGC -1.038758e+00  4.738963 10.15502 2.169621e-03 3.055805e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          logFC_shrunk df.total df.prior df.test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.0.WT   5.060301e-16 68.39919 65.39919       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAC -6.661972e-01 68.39919 65.39919       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAG -8.823465e-01 68.39919 65.39919       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACC  1.207031e-01 68.39919 65.39919       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACG -1.016627e-01 68.39919 65.39919       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AGC -1.030935e+00 68.39919 65.39919       1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Calculate "absolute" log-fold changes with limma</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">calculateRelativeFC</span><span class="op">(</span><span class="va">se</span>, <span class="va">design</span>, coef <span class="op">=</span> <span class="st">"Conditioncis_output"</span>, </span></span>
<span class="r-in"><span>                           method <span class="op">=</span> <span class="st">"limma"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             logFC      CI.L     CI.R   AveExpr        t      P.Value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.0.WT  1.9474761 1.5292108 2.365741 19.757630 9.144191 9.237987e-19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAC 1.2874854 0.6745388 1.900432  4.417300 4.125197 4.227413e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAG 1.0494394 0.5382396 1.560639  5.581250 4.031733 6.250330e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACC 2.0664575 1.6160089 2.516906 12.504065 9.009616 2.738680e-18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACG 1.8444895 1.3981560 2.290823 13.217517 8.115994 2.737555e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AGC 0.9173399 0.3223443 1.512336  4.627474 3.027900 2.568326e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            adj.P.Val         B  se.logFC df.total df.prior</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.0.WT  3.079329e-17 34.491225 0.2129741      600      Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAC 1.537241e-04  1.802578 0.3121028      600      Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAG 2.232261e-04  1.302156 0.2602949      600      Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACC 7.824800e-17 33.291805 0.2293613      600      Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACG 3.421944e-14 25.725045 0.2272660      600      Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AGC 6.941422e-03 -2.063388 0.3029624      600      Inf</span>
<span class="r-in"><span><span class="co">## Calculate log-fold changes relative to the WT sequence with limma</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="st">"f.0.WT"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">calculateRelativeFC</span><span class="op">(</span><span class="va">se</span>, <span class="va">design</span>, coef <span class="op">=</span> <span class="st">"Conditioncis_output"</span>, </span></span>
<span class="r-in"><span>                           method <span class="op">=</span> <span class="st">"limma"</span>, WTrows <span class="op">=</span> <span class="st">"f.0.WT"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 logFC        CI.L        CI.R   AveExpr             t</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.0.WT   9.552321e-08 -0.02134725  0.02134744 19.757630  1.061086e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAC -6.050453e-01 -1.19863707 -0.01145359  4.417300 -2.417050e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAG -8.921801e-01 -1.41471440 -0.36964582  5.581250 -4.048771e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACC  1.233369e-01  0.05349146  0.19318235 12.504065  4.187362e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACG -1.002978e-01 -0.12552201 -0.07507357 13.217517 -9.428860e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AGC -9.852809e-01 -1.66066239 -0.30989941  4.627474 -3.459365e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              P.Value    adj.P.Val           B    se.logFC df.total df.prior</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.0.WT  9.999918e-01 0.9999918338 -10.2853001 0.009002401 6.904162 3.904162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAC 4.676895e-02 0.0534502279  -4.8181840 0.250323924 6.904162 3.904162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AAG 5.021241e-03 0.0079702233  -2.7275623 0.220358245 6.904162 3.904162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACC 4.226773e-03 0.0071038198  -4.8399208 0.029454563 6.904162 3.904162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.ACG 3.435219e-05 0.0002862682   0.1043135 0.010637319 6.904162 3.904162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f.1.AGC 1.078800e-02 0.0151943682  -3.3263517 0.284815526 6.904162 3.904162</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Charlotte Soneson, Michael Stadler.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

